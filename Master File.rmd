---
title: "Group 27 Project"
author: "Jade Butler, Sonia Saxon, Joanna Mendelsohn, Kai Smith"
date: "`r Sys.Date()`"
output: openintro::lab_report
---

```{r load-packages, message=FALSE}
library(tidyverse)
library(openintro)
library(rmarkdown)
library(BSDA)
library(infer)
library (ggpubr)
library(car)
library(ggplot2)
library(broom)
```

### Problem 1: Read in and Prepare Data
```{r PR}
Fish <- read.csv("fish.csv")
Fish$Site <- factor(Fish$Site)
Fish$AgeP<- factor(Fish$AgeP)
count(Fish)
Fish2 <- Fish[which(Fish$YrCaught==Fish$YrTagged),] #this is our new data set for the rest of the assignment
Total <- count(Fish2)
weight <- sum(is.na(Fish2$Weight)) #filter out missing values for Weight
age <- sum(is.na(Fish2$AgeP)) #filter out missing values for Age should be 0
site <- sum(is.na(Fish2$Site)) #filter out missing values for Site should be 0
length <- sum(is.na(Fish2$Length)) #filter out missing values for Length should be 0
#print table with Fish2, number of missing values for weight, age, length and site -> Omit YrCaught and YrTagged from this table
Fish2 %>%
  count(count(Fish2), weight, age, site, length)
```



### Problem 3:  EDA
#### Part 3a)
```{r Univariate EDA}
#graph for Age, Weight and Length each
h1 <- ggplot(Fish2, aes(x = AgeP)) +
  geom_bar(fill = "cornflowerblue") + 
  ylim(0,3500) + 
  labs(x = "Probable Age", 
       title = "Fish Measured Age 0-3") #right skewed unimodal
h2 <- ggplot(data = Fish2, aes(x = Length)) + 
  geom_histogram(binwidth = 2, 
                 fill = "cornflowerblue") + 
  labs(title = "Captured Fish Measured Length", 
       x = "Length in mm") #right skewed bimodal
h3 <- ggplot(data = Fish2, aes(x = Weight)) +
  geom_histogram(binwidth = 2, 
                 fill = "cornflowerblue") + 
  ylim(0,50) + 
  labs(title = "Captured Fish Measured Weight", 
       x = "Weight in grams") #right skewed bimodal
ggarrange(h1, h2, h3)
summary(Fish2$Weight)
summary(Fish2$Length)
summary(Fish2$AgeP)

```

#### Part 3b)
```{r Bivariate EDA}
#graph for relationship between weight and length
s1 <- ggplot(Fish2, aes(x=Length, y=Weight)) +
  geom_point(color="cornflowerblue", 
             size = 1, 
             alpha=.5) +  
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Fish Measured Weight on Measured Length", 
       x = "Length in mm", 
       y = "Weight in grams")
(cor1 <- cor(Fish2$Length, Fish2$Weight))
s1
summary(Fish2$Length, Fish2$Weight)

```

### Problem 4:  Regression of Weight on Length
#### Part 4a)
```{r Scatterplot}
s2 <- ggplot(Fish2, aes(x=log(Length), y=Weight)) +
  geom_point(color="cornflowerblue", 
             size = 1, 
             alpha=.5) +  
  labs(title = "Natural Log Fish Measured Weight on Measured Length", 
       x = "Natural Log Length in mm", 
       y = "Natural Log Weight in grams")
s2

```

### The relationship of the natural log of fish measured weight in grams to the natural log of the measured fish length in millimeters shows positive correlation and is relatively linear. There is a minimal presence of outliers, but the strength of the possitive association between the natural log of fish length in millimeters to the natural log of fish weight in grams suggests that, on average, when fish length (in millimeters) increases, fish weight (in grams) also increases.

#### Part 4b)
```{r Reg W on L}
s3 <- ggplot(Fish2, aes(x=log(Length), y=Weight)) +
  geom_point(color="cornflowerblue", 
             size = 1, 
             alpha=.5) +  
  geom_smooth(method = "lm", se = FALSE, color="black") + 
  labs(title = "Natural Log Fish Measured Weight on Measured Length", 
       x = "Natural Log Length in mm", 
       y = "Natural Log Weight in grams")
s3
lm1.out <- lm(log(Fish2$Weight) ~ log(Fish2$Length))
  summary(lm1.out)
```
#### Write out the regression equation and interpret the estimated slope parameter in the context of the problem.
 y = mx + b
### regression equation
intercept = -11.35
slope = 2.98

y = 2.98x - 11.35


#### Part 4c)
```{r Reg Diagnostics}
### daignostics, need to enter in correct data frames still, copied from lesson 8 html
par(mfrow=c(2,2))
plot(BGSall$WT2, BGSall$HT2, xlab="Age 2 Weight (kg)", pch=19,
     ylab="Age 2 Height (cm)", cex.lab=1.25, cex.axis=1.25)
abline(lm.out, col="blue", lwd=2)
plot(BGSall$WT2, residuals(lm.out), xlab="Age 2 Weight (kg)", pch=19,
     ylab="Residuals", cex.lab=1.25, cex.axis=1.25)
abline(h=0,col="blue")
hist(residuals(lm.out), xlab="Residuals", main="")

```


#### Part 4e)
```{C.I }
# Create the right subsets of data, copied from lesson 6, HWK #5a
C.C <- filter(C.df, Cereal == "Cornflk")
C.O <- filter(C.df, Cereal == "OatBran")
t.test(C.O$Cholesterol,C.C$Cholesterol, paired=TRUE, alternative = "less")

## 
##  Paired t-test
## 
## data:  C.O$Cholesterol and C.C$Cholesterol
## t = -2.6149, df = 11, p-value = 0.01202
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf -0.1080601
## sample estimates:
## mean of the differences 
##                  -0.345
```



#### Part 4f)
```{r CI and PI}

```


### Problem 5:  Fish Length and Site
#### Part 5a)
```{r FL by Site}
# boxplots of fish length by site

b1 <- ggplot(Fish2, aes(x = Site, y = Length)) + 
  geom_boxplot() + xlab("Site Location") +
  ylab("Fish Fork Length (mm)")
b1
```

#### Part 5b)
```{r Inference for Length}
# two subsets, one for Site 1 data and other for Site 3 data

site1 <- Fish2 %>%
  filter(Site == "Site 1")

site3 <- Fish2 %>%
  filter(Site == "Site 3")

# reporting 95% confidence interval for difference in mean lengths b/w upstream
# and downstream sites

t.test(site1$Length, site3$Length, conf.level = 0.95)$conf.int
```
### We are 95% confident that the mean difference in fish length between the 
### upstream and downstream sites falls between about 2.6 and 6.6.

#### Part 5c)
```{r Testing Claim w/ Signif. Level}
summary(site1)
sd(site1$Length)
nrow(site1)

summary(site3)
sd(site3$Length)
nrow(site3)

zsum.test(mean.x = 92.58, sigma.x = 28.96313, n.x = 1207, mean.y = 87.97, 
          sigma.y = 23.37916, n.y = 1514)
```
### Temporary Note: Writing part of 5c on Google Docs

### Problem 6: Probable Age Class 2 by Site
#### Part 6a)
```{r AgeP 2 by Site}

```

#### Part 6b)
```{r CI P6}

```

#### Part 6c)
```{r HT P6}

```
