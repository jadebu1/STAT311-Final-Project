---
title: "Group 27 Project"
author: "Jade Butler, Sonia Saxon, Joanna Mendelsohn, Kai Smith"
date: "`r Sys.Date()`"
output: openintro::lab_report
---

```{r load-packages, message=FALSE}
library(tidyverse)
library(openintro)
library(rmarkdown)
library(BSDA)
library(infer)
library (ggpubr)
library(car)
library(ggplot2)
library(broom)
```

### Problem 1: Read in and Prepare Data
```{r PR}
Fish <- read.csv("fish.csv")
Fish$Site <- factor(Fish$Site)
Fish$AgeP<- factor(Fish$AgeP)
count(Fish)
Fish2 <- Fish[which(Fish$YrCaught==Fish$YrTagged),] #this is our new data set for the rest of the assignment
Total <- count(Fish2)
weight <- sum(is.na(Fish$Weight)) #filter out missing values for Weight
age <- sum(is.na(Fish$AgeP)) #filter out missing values for Age
site <- sum(is.na(Fish$Site)) #filter out missing values for Site
length <- sum(is.na(Fish$Length)) #filter out missing values for Length
#print table with Fish2, number of missing values for weight, age, length and site -> Omit YrCaught and YrTagged from this table
Fish2 %>%
  count(count(Fish2), weight, age, site, length)
```



### Problem 3:  EDA
#### Part 3a)
```{r Univariate EDA}
#graph for Age, Weight and Length each
h1 <- ggplot(Fish2, aes(x = AgeP)) +
  geom_bar(fill = "cornflowerblue") + 
  ylim(0,3500) + 
  labs(x = "Probable Age", 
       title = "Fish Measured Age 0-3") #right skewed unimodal
h2 <- ggplot(data = Fish2, aes(x = Length)) + 
  geom_histogram(binwidth = 2, 
                 fill = "cornflowerblue") + 
  labs(title = "Captured Fish Measured Length", 
       x = "Length in mm") #right skewed bimodal
h3 <- ggplot(data = Fish2, aes(x = Weight)) +
  geom_histogram(binwidth = 2, 
                 fill = "cornflowerblue") + 
  ylim(0,50) + 
  labs(title = "Captured Fish Measured Weight", 
       x = "Weight in grams") #right skewed bimodal
ggarrange(h1, h2, h3)
summary(Fish2$Weight)
summary(Fish2$Length)
summary(Fish2$AgeP)

```

#### Part 3b)
```{r Bivariate EDA}
#graph for relationship between weight and length

s1 <- ggplot(Fish2, aes(x=Length, y=Weight)) +
  geom_point(color="cornflowerblue", 
             size = 1, 
             alpha=.5) +  
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Fish Measured Weight on Measured Length", 
       x = "Length in mm", 
       y = "Weight in grams")
(cor1 <- cor(Fish2$Length, Fish2$Weight))
s1
summary(Fish2$Length, Fish2$Weight)

```

### Problem 4:  Regression of Weight on Length
#### Part 4a)
```{r Scatterplot}
s2 <- ggplot(Fish2, aes(x=log(Length), y=Weight)) +
  geom_point(color="cornflowerblue", 
             size = 1, 
             alpha=.5) +  
  labs(title = "Natural Log Fish Measured Weight on Measured Length", 
       x = "Natural Log Length in mm", 
       y = "Natural Log Weight in grams")
s2

```

### The relationship of the natural log of fish measured weight in grams to the natural log of the measured fish length in millimeters shows positive correlation and is relatively linear. There is a minimal presence of outliers, but the strength of the possitive association between the natural log of fish length in millimeters to the natural log of fish weight in grams suggests that, on average, when fish length (in millimeters) increases, fish weight (in grams) also increases.

#### Part 4b)
```{r Reg W on L}
s3 <- ggplot(Fish2, aes(x=log(Length), y=Weight)) +
  geom_point(color="cornflowerblue", 
             size = 1, 
             alpha=.5) +  
  geom_smooth(method = "lm", se = FALSE, color="black") + 
  labs(title = "Natural Log Fish Measured Weight on Measured Length", 
       x = "Natural Log Length in mm", 
       y = "Natural Log Weight in grams")
s3

lm1.out <- lm(log(Fish2$Weight) ~ log(Fish2$Length))
  summary(lm1.out)
```
#### Write out the regression equation and interpret the estimated slope parameter in the context of the problem.
 y = mx + b
### regression equation
intercept = -11.35
slope = 2.98

y = 2.98x - 11.35

#### Sonia's Regression code

lm1.out <-
lm(log(Fish2$Length)$log(Fish2$Weight) ~ Length$Weight)
summary(lm1.out)
plotlog(Fish2$Length)log(Fish2$Weight) 
xlab="Natural Log of Length in mm"
ylab= "Natural Log of Weight in grams"
abline(lm1.out, lty=2, lwd=2, col="blue")
points(mean(log(Fish2$Length)$log(Fish2$Weight)),
mean(log(Fish24Length)$log(Fish2$Weight)),
pch=19, col="black") 

lm1.out <-

summary(lm1.out)

#### Part 4c)
```{r Reg Diagnostics}
# Linearity of the data
plot(lm1.out, 1)
# Normality of residuals
plot(lm1.out, 2)
#Cook's distance
plot(lm1.out, 4)
# High leverage points
plot(lm1.out, 5)
```


#### Part 4e)
```{r Beta1 EQ 3}

```



#### Part 4f)
```{r CI and PI}

```


### Problem 5:  Fish Length and Site
#### Part 5a)
```{r FL by Site}

```

#### Part 5b)
```{r Inference for Length}

```


### Problem 6: Probable Age Class 2 by Site
#### Part 6a)
```{r AgeP 2 by Site}

```

#### Part 6b)
```{r CI P6}

```

#### Part 6c)
```{r HT P6}

```

...

